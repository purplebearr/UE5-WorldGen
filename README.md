Copy and paste

Original by fettis GameDev, made into c++ (needs optimization)
